<!doctype html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link href="css/mui.min.css" rel="stylesheet" />
		<style>
			#searchInput {
				width: 270px;
				height: 30px;
				margin: 7px;
				border-radius: 20px;
				border-style: hidden;
				text-indent: 20px;
				background: white;
			}
			
			.hot-search-btn {
				border: hidden;
				background: #F2F2F2;
				margin-bottom: 5px;
				border-radius: 25px;
			}
			
			.left-icon {
				display: inline-block;
				float: left;
				height: 20px;
				width: 20px;
			}
			
			.mui-row {
				margin-top: 10px;
				margin-left: 10px;
			}
			
			.mui-row span {
				color: gray;
			}
			
			.mui-content {
				background: white;
			}
			
			.sm-icon {
				display: inline-block;
				float: left;
				height: 10px;
				width: 10px;
				margin-top: 5px;
			}
			
			#searchImg {
				position: fixed;
				left: 50px;
				top: 32px;
				z-index: 999;
				height: 20px;
				width: 20px;
			}
			
			#searchBtn {
				margin-top: 10px;
				border: none;
				color: white;
				font-size: 16px;
				background: transparent;
				padding: 0;
			}
			#mui-template{
				margin-top: 20px;
			}
		</style>
	</head>

	<body style="background: white;">
		<header class="mui-bar mui-bar-nav">
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left "></a>
			<img src="images/ic_search.png" id="searchImg" />
			<form action="">
				<input type="search" id="searchInput" placeholder="输入服务项和服务内容"></input>
				<button id="searchBtn" type="submit" class="mui-pull-right">搜索</button>
			</form>
		</header>
		<div class="mui-content">
			<div class="mui-row" id="historySearch">
				<!--<img src="images/╦Л╦э.png" class="left-icon" />-->
				<span class="mui-pull-left">历史搜索</span>
				<button type="button" class="mui-pull-right hot-search-btn" id="clearHistory"><img src="images/img123.png" class="sm-icon"/>清空历史</button>
			</div>
			<div class="mui-row" id="mui-template0">
				<script type="text/template" id="temp0">
					<% for(var i in record){ var item=record[i]; %>
					<button type="button" class="hot-search-btn"><%=item%></button>
					<%}%>
				</script>
			</div>
			<div class="mui-row">
				<!--<img src="images/img67.png" class="left-icon">-->
				<span class="mui-pull-left">热门搜索</span>

			</div>
			<div class="mui-row" id="mui-template">
				<script type="text/template" id="temp">
					<% for(var i in record){ var item=record[i]; %>
					<button type="button" class="hot-search-btn"><%=item%></button>
					<%}%>
				</script>
			</div>
		</div>
		<script src="js/mui.min.js"></script>
		<script type="text/javascript" src="js/app.js"></script>
		<script type="text/javascript" src="js/xiachenshi.js"></script>
		<script type="text/javascript" src="js/arttmpl.js"></script>
		<script type="text/javascript">
			mui.plusReady(function() {
				var history = (localStorage.getItem('history') || '').trim();
				if(history) {
					document.getElementById('historySearch').hidden = false;
					var hisArr = history.split(' ', 5);
					var str = template('temp0', {
						"record": hisArr
					});
					document.getElementById("mui-template0").innerHTML = str;
				} else {
					document.getElementById('historySearch').hidden = true;
				}

				var hotSearchParam = {
					service: 'Hlbr365app.Member.GetHotSearch'
				};
				wAjax(hotSearchParam, function(result) {
					var hotList = result.data.info;
					var str = template('temp', {
						"record": hotList
					});
					document.getElementById("mui-template").innerHTML = str;
				})

				//				document.getElementById('searchBtn').addEventListener('tap', function() {
				//					document.getElementById('searchInput').value = '';
				//					//					var input = document.getElementById('searchInput').value;
				//					//					if(!input){
				//					//						plus.nativeUI.toast("请输入内容!");
				//					//						return;
				//					//					searchGoods(input);
				//				})

				document.querySelector('form').addEventListener('submit', function(e) {
					e.preventDefault(); // 阻止默认事件
					document.activeElement.blur();
					//  var searchBtn = document.getElementById('searchBtn');
					//  mui.trigger(searchBtn);
					var input = document.getElementById('searchInput').value;
					if(!input) {
						plus.nativeUI.toast("请输入内容!");
						return;
					}
					var history = localStorage.getItem('history') || '';
					history = input + ' ' + history;
					localStorage.setItem('history', history);
					searchGoods(input);
				});

				document.getElementById('searchBtn').addEventListener('tap', function() {
					var input = document.getElementById('searchInput').value;
					if(!input) {
						plus.nativeUI.toast("请输入内容!");
						return;
					}
					var history = localStorage.getItem('history') || '';
					history = input + ' ' + history;
					localStorage.setItem('history', history);
					searchGoods(input);
				})

				document.getElementById('clearHistory').addEventListener('tap', function() {
					localStorage.removeItem('history');
					document.getElementById('mui-template0').innerHTML = '';
				})
			})

			function searchGoods(input) {
				console.log(input);
				mui.openWindow({
					url: 'service_list.html',
					id: 'service_list.html',
					extras: {
						input: input
					}
				});
			}

			mui("#mui-template").on('tap', 'button', function(e) {
				var name = this.innerHTML;
				searchGoods(name);
			});
		</script>
	</body>

</html>