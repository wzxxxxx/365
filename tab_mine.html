<!doctype html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link href="css/mui.min.css" rel="stylesheet" />

		<style>
			.bg {
				background: url(images/img5.png) no-repeat;
				background-size: 100% 100%;
				height: 150px;
				margin-bottom: 60px;
				padding-top: 100px;
			}
			
			
			.span-center {
				width: 100%;
				float: left;
				text-align: center;
			}
			
			.mui-table-view {
				width: 95%;
				margin-left: 10px;
				margin-top: 20px;
				border-radius: 10px;
				-webkit-box-shadow: 0 0 5px antiquewhite;
				-moz-box-shadow: 0 0 5px antiquewhite;
				box-shadow: 0 0 5px antiquewhite;
			}
			
			.mui-table-view:before {
				height: 0;
			}
			
			.mui-table-view:after {
				height: 0;
			}
			.mui-table-view-cell:after{
				right: 15px;
				left: 15px;
			}
			#relogin {
				color: red;
			}
			
			#avatar {
				clear: both;
				display: block;
				margin: auto;
				border-radius: 40px;
				width: 80px;
				height: 80px;
			}
		</style>

	</head>

	<body>
		<div class="mui-content">
			<div class="mui-content bg">
				<img src="images/img54.png" id="avatar" />
				<span class="span-center" id="name">test</span>
			</div>
			<ul class="mui-table-view">
				<li class="mui-table-view-cell">
					<a id="notice" class="mui-navigate-right">
						编辑用户信息
					</a>
				</li>
				<li class="mui-table-view-cell">
					<a id="collection" class="mui-navigate-right">
						我的收藏
					</a>
				</li>
				<li class="mui-table-view-cell">
					<a id="youhuiquan" class="mui-navigate-right">
						我的优惠劵
					</a>
				</li>
			</ul>
			<ul class="mui-table-view">
				<li class="mui-table-view-cell">
					<a id="settings" class="mui-navigate-right">
						设置
					</a>
				</li>

			</ul>
			<ul class="mui-table-view">
				<li class="mui-table-view-cell">
					<a id="relogin" class=" mui-text-center">
						退出登录
					</a>
				</li>

			</ul>
		</div>
		<script src="js/mui.min.js"></script>
		<script type="text/javascript" src="js/app.js"></script>
		<script type="text/javascript">
			mui.plusReady(function() {
				var settingsBox = document.getElementById('settings');
				var reloginBox = document.getElementById('relogin');
				var collectionBox = document.getElementById('collection');
				var noticeBox = document.getElementById('notice');
				var youhuiquanBox = document.getElementById('youhuiquan');
				youhuiquanBox.addEventListener('tap', function(){
					mui.openWindow({
						url: 'my_coupon.html',
						id: 'my_coupon.html'

					});
				})
				settingsBox.addEventListener('tap', function(event) {
					mui.openWindow({
						url: 'settings.html',
						id: 'settings.html'

					});
				});
				reloginBox.addEventListener('tap', function() {
					mui.openWindow({
						url: 'login.html',
						id: 'login.html'
					})
//					plus.webview.show('login.html', 'pop-in');
				});
				collectionBox.addEventListener('tap', function() {
					mui.openWindow({
						url: 'collections.html',
						id: 'collections.html'
					})
				});
				noticeBox.addEventListener('tap', function() {
					mui.openWindow({
						url: 'edit_profile.html',
						id: 'edit_profile.html'
					})
				})

				var loginData = JSON.parse(localStorage.getItem('login'));
				if(!loginData) {
					return;
				}
				var mbi_id = loginData.data.info.mbi_id;
				getProfile(mbi_id);
			})

			function getProfile(id) {
				var profileParam = {
					service: 'Hlbr365app.Member.GetInfo',
					mbi_id: id
				}
				wAjax(profileParam, function(result) {
					var info = result.data.info;
					document.getElementById('name').innerHTML = info.mei_real_name || '未命名';
					if(info.mei_head) {
						document.getElementById('avatar').src = info.mei_head;
					}
				})
			}
		</script>
	</body>

</html>
